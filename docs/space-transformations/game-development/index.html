<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="3D Snake Game # Introduction # In the realm of web development, p5.js has gained significant popularity for its simplicity and versatility in creating interactive graphics and animations. The ability to represent three-dimensional (3D) objects and environments opens up a new dimension of possibilities for learning. In this article, the topic of dynamic environments will be explored by implementing a three-dimensional interactive game using the p5.js library. The focus of this study is to develop a game environment in which a player-controlled cube moves within a cubic arena, collecting randomly generated food items while avoiding obstacles and trying to score as many points as possible."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Game Development"><meta property="og:description" content="3D Snake Game # Introduction # In the realm of web development, p5.js has gained significant popularity for its simplicity and versatility in creating interactive graphics and animations. The ability to represent three-dimensional (3D) objects and environments opens up a new dimension of possibilities for learning. In this article, the topic of dynamic environments will be explored by implementing a three-dimensional interactive game using the p5.js library. The focus of this study is to develop a game environment in which a player-controlled cube moves within a cubic arena, collecting randomly generated food items while avoiding obstacles and trying to score as many points as possible."><meta property="og:type" content="article"><meta property="og:url" content="https://jurodriguezf.github.io/showcase/docs/space-transformations/game-development/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-06-16T18:42:14-05:00"><title>Game Development | Showcase Template</title><link rel=manifest href=/showcase/manifest.json><link rel=icon href=/showcase/favicon.png type=image/x-icon><link rel=stylesheet href=/showcase/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/showcase/flexsearch.min.js></script>
<script defer src=/showcase/en.search.min.3a8d658c77eb93c7f12a2b8af49a700131e474f288eefb605d9fa61576dbe5a7.js integrity="sha256-Oo1ljHfrk8fxKiuK9JpwATHkdPKI7vtgXZ+mFXbb5ac=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/showcase/><span>Showcase Template</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Space Transformations</span><ul><li><a href=/showcase/docs/space-transformations/game-development/ class=active>Game Development</a></li></ul></li><li class=book-section-flat><span>Visual Illusions</span><ul><li><a href=/showcase/docs/visual-illusions/binocular-cues/>Binocular cues</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/showcase/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Game Development</strong>
<label for=toc-control><img src=/showcase/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#3d-snake-game><strong>3D Snake Game</strong></a></li><li><a href=#introduction><strong>Introduction</strong></a></li><li><a href=#background><strong>Background</strong></a><ul><li><a href=#solution-p5-sketch><strong>Solution: P5 Sketch</strong></a></li></ul></li><li><a href=#solution-code><strong>Solution: Code</strong></a></li><li><a href=#conclusions><strong>Conclusions</strong></a></li><li><a href=#future-work><strong>Future work</strong></a></li><li><a href=#references><strong>References</strong></a></li></ul></nav></aside></header><article class=markdown><h1 id=3d-snake-game><strong>3D Snake Game</strong>
<a class=anchor href=#3d-snake-game>#</a></h1><h1 id=introduction><strong>Introduction</strong>
<a class=anchor href=#introduction>#</a></h1><p>In the realm of web development, <em>p5.js</em> has gained significant popularity for its simplicity and versatility in creating interactive graphics and animations. The ability to represent three-dimensional (3D) objects and environments opens up a new dimension of possibilities for learning. In this article, the topic of dynamic environments will be explored by implementing a three-dimensional interactive game using the <em>p5.js</em> library. The focus of this study is to develop a game environment in which a player-controlled cube moves within a cubic arena, collecting randomly generated food items while avoiding obstacles and trying to score as many points as possible.</p><p>This workshop focuses on 4 main aspects, but the main focus lies in <strong>space transformations</strong>:</p><ol><li><p><strong>Interactive 3D Graphics:</strong> This is demonstrated by the use of 3D rendering techniques to create an interactive game environment. It covers concepts such as translating, rotating, and projecting objects in 3D space.</p></li><li><p><strong>Visualization Techniques:</strong> It also showcases visualization techniques by rendering projections of the 3D cube onto 2D planes to provide additional perspectives of the game world to help the player navigate through a 3D environment. It also provides a Heads-Up Display (HUD) providing necessary information to the player.</p></li><li><p><strong>User Interaction:</strong> It also incorporates keyboard input for controlling the movement of the cube within the 3D environment by mapping of keyboard keys to specific actions like movement, acceleration and pausing.</p></li><li><p><strong>Game Logic:</strong> The workshop also implements basic game mechanics, such as collision detection between the player&rsquo;s cube with the food and the arena boundaries. It also keeps track of the player&rsquo;s score as they collect the food.</p></li></ol><h1 id=background><strong>Background</strong>
<a class=anchor href=#background>#</a></h1><p>The field of computer graphics and interactive 3D environments has been a subject of extensive research and development, with numerous studies focusing on various aspects of rendering, transformations, and user interaction.</p><p>One important area of research in computer graphics is the study of 2D and 3D transformations. Transformations play a fundamental role in creating immersive virtual environments and enabling interactive user experiences. There are different transformation techniques, such as translation, rotation, scaling, and projection, to manipulate objects in 2D and 3D space.</p><p>There are various algorithms and mathematical representations for performing transformations. Common approaches include matrix operations, Euler angles and quaternions.</p><p>The space transformations used in this workshop consist of only matrix operations, used to represent and move the position vectors of the player (cube) and the food.</p><p>Knowing that a vector may be interpreted geometrically as a sequence of axially-aligned displacements, if we interpret the rows of a matrix as the basis vectors of a coordinate space, then
multiplication by the matrix performs a coordinate space transformation. If aM=b,
we say that M transformed a to b [1].</p><h2 id=solution-p5-sketch><strong>Solution: P5 Sketch</strong>
<a class=anchor href=#solution-p5-sketch>#</a></h2><iframe id=3d-snake style=width:630px;height:630px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js></script>
            <script src=https://freshfork.github.io/p5.EasyCam/p5.easycam.js></script>
            
            
            
            
            
            <script src=/showcase/sketches/space-transformations/3d-snake.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h1 id=solution-code><strong>Solution: Code</strong>
<a class=anchor href=#solution-code>#</a></h1><p>The <code>setup()</code> function sets up the camera control using the EasyCam library in a specific position so that all planes are visible.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>easycam</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createEasyCam</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>setState</span>({  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>distance</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>437</span>, 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>center</span><span style=color:#f92672>:</span>   [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rotation</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>0.92</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.09</span>, <span style=color:#ae81ff>0.38</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.03</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>It also initializes variables such as: player position and direction vectors; the food position vector, which has components of random values within the arena; keyboard mappings, that are defined as vectors, which will be added to the position vector to update the player position; and font for text rendering.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// Position and direction vector initialization
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>playerPositionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>playerDirectionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Food position vector
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomFoodX</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomFoodY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomFoodZ</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>foodPositionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#a6e22e>randomFoodX</span>, <span style=color:#a6e22e>randomFoodY</span>, <span style=color:#a6e22e>randomFoodZ</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Move time initialization
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>nextMoveTime</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>millis</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Keyboard keys direction vector mapping
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>keyMapping</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowRight&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>( <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowLeft&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowUp&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowDown&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;w&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;s&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;p&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>The <code>delayMovement()</code> function controls the delayed movement of the player cube, so that it not moves at a high rate (of approximately 60 frames per second).</p><p>It also checks if the current time has exceeded the next move time (delaying the movement) and updates the player&rsquo;s position accordingly. It also checks for collisions between the player and the food, updating the score and randomizing the food&rsquo;s position if there is a collision (meaning the player grabbed the food). Additionally, it handles teleporting the player cube back to the center and resetting the score if it goes outside the arena.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>millis</span>() <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>nextMoveTime</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Calculate the next position
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>nextPosition</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>playerPositionVector</span>, <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>mult</span>(<span style=color:#a6e22e>playerDirectionVector</span>, <span style=color:#a6e22e>CELL_SIZE</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check if the next position is outside the arena
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>halfCellSize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>CELL_SIZE</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>nextPosition</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>halfCellSize</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>nextPosition</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>halfCellSize</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>nextPosition</span>.<span style=color:#a6e22e>z</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>halfCellSize</span>
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>teleportToCenter</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>playerPositionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>nextPosition</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check for player collission with food
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>playerPositionVector</span>.<span style=color:#a6e22e>equals</span>(<span style=color:#a6e22e>foodPositionVector</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>randomizeFoodPosition</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>playerScore</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>nextMoveTime</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>keyIsDown</span>(<span style=color:#a6e22e>SHIFT</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>MOVE_DELAY</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>SHIFT_ACCELERATION</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>MOVE_DELAY</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The <code>drawArena()</code> function draws the arena using projections on the XY, ZX, and ZY planes using lines and rectangles.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xyPlaneZ</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zxPlaneY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zyPlaneX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Draw planes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>CELL_SIZE</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// XY plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>line</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>xyPlaneZ</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>xyPlaneZ</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>i</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>xyPlaneZ</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>xyPlaneZ</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ZX plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>line</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#a6e22e>i</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ZY plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#a6e22e>i</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The <code>drawCube()</code> function draws the player cube at its current position in the 3D space, using space transformations to achieve it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>translate</span>(...<span style=color:#a6e22e>playerPositionVector</span>.<span style=color:#a6e22e>array</span>());
</span></span><span style=display:flex><span><span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>box</span>(<span style=color:#a6e22e>CELL_SIZE</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>pop</span>();
</span></span></code></pre></div><p>Similarly, the <code>drawFood()</code> function draws the food item at its current position in the 3D space.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>translate</span>(...<span style=color:#a6e22e>foodPositionVector</span>.<span style=color:#a6e22e>array</span>());
</span></span><span style=display:flex><span><span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>box</span>(<span style=color:#a6e22e>CELL_SIZE</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>pop</span>();
</span></span></code></pre></div><p>The <code>drawProjections()</code> function draws the projections of the any position vector onto the XY, ZX, and ZY planes using lines and rectangles. In the code, it is used for drawing the projections of both the player and the food.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawProjections</span>(<span style=color:#a6e22e>positionVector</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(...<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>array</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xyPlaneZ</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zxPlaneY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zyPlaneX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Draw lines from cube to each plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>); <span style=color:#75715e>// Blue (XY plane projection)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xyLineLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>z</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>xyPlaneZ</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>xyLineLength</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Green (ZX plane projection)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>zxLineLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>zxPlaneY</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>zxLineLength</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Red (ZY plane projection)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>zyLineLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>zyPlaneX</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>zyLineLength</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// XY plane projection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>); <span style=color:#75715e>// Blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>rectMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ZX plane projection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>z</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>rectMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotateX</span>(<span style=color:#a6e22e>HALF_PI</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ZY plane projection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>z</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>rectMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotateY</span>(<span style=color:#a6e22e>HALF_PI</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The <code>drawHud()</code> function renders the Heads-Up Display (HUD) on the screen using the EasyCam library, displaying the player&rsquo;s score and control instructions.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>beginHUD</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>490</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;Score: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>playerScore</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;&lt;- and -&gt; keys: X direction&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;↑ and ↓ keys: Y direction&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>192</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;&#39;w&#39; and &#39;s&#39; keys: Z direction&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;&#39;shift&#39; key: accelerate&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>endHUD</span>();
</span></span></code></pre></div><p>The <code>randomizeFoodPosition()</code> function generates a random position for the food item within the arena. This function is called whenever there is a collision of the player with the food. For some reason the food was sometimes generated outside the arena, so it was encapsulated inside a loop that, before updating the food position vector, first validates if the food is inside the arena.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>validPosition</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>validPosition</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomX</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomZ</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>foodPositionVector</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>randomX</span>, <span style=color:#a6e22e>randomY</span>, <span style=color:#a6e22e>randomZ</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check if the generated position is within the arena
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>randomX</span>) <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>randomY</span>) <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>randomZ</span>) <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>validPosition</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The resulting code is as follows:</p><details><summary>Complete implementation</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>CELL_SIZE</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>CELLS_PER_AXIS</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>11</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ARENA_SIZE</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>CELL_SIZE</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELLS_PER_AXIS</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ARENA_SIZE</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>MOVE_DELAY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>700</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>SHIFT_ACCELERATION</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>playerPositionVector</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>playerDirectionVector</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>foodPositionVector</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>playerScore</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>keyMapping</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nextMoveTime</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>easycam</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Load font
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>font</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadFont</span>(<span style=color:#e6db74>&#34;https://cdnjs.cloudflare.com/ajax/libs/bwip-js/2.0.6/Inconsolata.otf&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>600</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>easycam</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createEasyCam</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>setState</span>({  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>distance</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>437</span>, 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>center</span><span style=color:#f92672>:</span>   [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rotation</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>0.92</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.09</span>, <span style=color:#ae81ff>0.38</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.03</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Position and direction vector initialization
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>playerPositionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>playerDirectionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Food position vector
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomFoodX</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomFoodY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomFoodZ</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>foodPositionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#a6e22e>randomFoodX</span>, <span style=color:#a6e22e>randomFoodY</span>, <span style=color:#a6e22e>randomFoodZ</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Move time initialization
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>nextMoveTime</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>millis</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Keyboard keys direction vector mapping
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>keyMapping</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowRight&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>( <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowLeft&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowUp&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;ArrowDown&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;w&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;s&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;p&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Font setup
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>textFont</span>(<span style=color:#a6e22e>font</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>LEFT</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>delayMovement</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>drawHud</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>drawArena</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>drawCube</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>drawFood</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Delay cube movement
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>delayMovement</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>millis</span>() <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>nextMoveTime</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Calculate the next position
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>nextPosition</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>playerPositionVector</span>, <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>mult</span>(<span style=color:#a6e22e>playerDirectionVector</span>, <span style=color:#a6e22e>CELL_SIZE</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check if the next position is outside the arena
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>halfCellSize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>CELL_SIZE</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>nextPosition</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>halfCellSize</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>nextPosition</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>halfCellSize</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>nextPosition</span>.<span style=color:#a6e22e>z</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>halfCellSize</span>
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>teleportToCenter</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>playerPositionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>nextPosition</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check for player collission with food
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>playerPositionVector</span>.<span style=color:#a6e22e>equals</span>(<span style=color:#a6e22e>foodPositionVector</span>)) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>randomizeFoodPosition</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>playerScore</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>nextMoveTime</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>keyIsDown</span>(<span style=color:#a6e22e>SHIFT</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>MOVE_DELAY</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>SHIFT_ACCELERATION</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>MOVE_DELAY</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Draw arena
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawArena</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#39;gray&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xyPlaneZ</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zxPlaneY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zyPlaneX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Draw planes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>CELL_SIZE</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// XY plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>line</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>xyPlaneZ</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>xyPlaneZ</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>i</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>xyPlaneZ</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>xyPlaneZ</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ZX plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>line</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#a6e22e>i</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>zxPlaneY</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ZY plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>i</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#a6e22e>i</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>zyPlaneX</span>, <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Cube rendering
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawCube</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(...<span style=color:#a6e22e>playerPositionVector</span>.<span style=color:#a6e22e>array</span>());
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>box</span>(<span style=color:#a6e22e>CELL_SIZE</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>drawProjections</span>(<span style=color:#a6e22e>playerPositionVector</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Food rendering
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawFood</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(...<span style=color:#a6e22e>foodPositionVector</span>.<span style=color:#a6e22e>array</span>());
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>box</span>(<span style=color:#a6e22e>CELL_SIZE</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>drawProjections</span>(<span style=color:#a6e22e>foodPositionVector</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Draw the projections in each plane of a given vector
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawProjections</span>(<span style=color:#a6e22e>positionVector</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(...<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>array</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xyPlaneZ</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zxPlaneY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zyPlaneX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Draw lines from cube to each plane
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>); <span style=color:#75715e>// Blue (XY plane projection)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xyLineLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>z</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>xyPlaneZ</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>xyLineLength</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Green (ZX plane projection)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>zxLineLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>zxPlaneY</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>zxLineLength</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Red (ZY plane projection)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>zyLineLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>zyPlaneX</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>zyLineLength</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// XY plane projection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>); <span style=color:#75715e>// Blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>rectMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ZX plane projection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>z</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>rectMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotateX</span>(<span style=color:#a6e22e>HALF_PI</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ZY plane projection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>positionVector</span>.<span style=color:#a6e22e>z</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// Red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>rectMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotateY</span>(<span style=color:#a6e22e>HALF_PI</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>, <span style=color:#a6e22e>CELL_SIZE</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Teleport the player to the center of the arena and reset score
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>teleportToCenter</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>playerPositionVector</span>.<span style=color:#a6e22e>set</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>playerScore</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// HUD drawing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawHud</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textSize</span>(<span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>beginHUD</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>490</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;Score: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>playerScore</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;&lt;- and -&gt; keys: X direction&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;↑ and ↓ keys: Y direction&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>192</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;&#39;w&#39; and &#39;s&#39; keys: Z direction&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;&#39;shift&#39; key: accelerate&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>endHUD</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Randomize food position
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>randomizeFoodPosition</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>validPosition</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>validPosition</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomX</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomZ</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_ARENA_SIZE</span>, <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>CELL_SIZE</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>CELL_SIZE</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>foodPositionVector</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>randomX</span>, <span style=color:#a6e22e>randomY</span>, <span style=color:#a6e22e>randomZ</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check if the generated position is within the arena
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>randomX</span>) <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>randomY</span>) <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>randomZ</span>) <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>HALF_ARENA_SIZE</span>
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>validPosition</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Key press events
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pressedKey</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>keyMapping</span>[<span style=color:#a6e22e>key</span>];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Change direction vector when key is pressed
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pressedKey</span>) <span style=color:#a6e22e>playerDirectionVector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pressedKey</span>;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>//if (key === &#34;d&#34;)console.log(easycam.getState())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>key</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#a6e22e>randomizeFoodPosition</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h1 id=conclusions><strong>Conclusions</strong>
<a class=anchor href=#conclusions>#</a></h1><p>The workshop demonstrates the ability to create a 3D visualization using the p5.js library. It showcases how p5.js can be used to render 3D objects, handle camera perspectives, and apply transformations to create an immersive experience.</p><p>The implementation of the 3D cube within an arena allows users to navigate and interact with the environment. The code showcases techniques for representing spatial relationships and enables users to move and explore the 3D space using keyboard inputs.</p><p>It incorporates collision detection between the player (cube) and the food, providing an interaction mechanism within the 3D environment. This demonstrates how game elements can be incorporated into a 3D setting for future work.</p><p>It also showcases the creation of a Heads-Up Display (HUD) using p5.js, providing users with essential information such as the player score and control instructions.</p><p>The code also serves as a foundation for developing more complex games or interactive applications within a 3D environment.</p><h1 id=future-work><strong>Future work</strong>
<a class=anchor href=#future-work>#</a></h1><p>This is really close to become a 3D Snake Game, which was the original idea of the workshop. Currently, the code represents a single cube as the player&rsquo;s object. To convert it into a snake game, one would need to implement a snake body composed of multiple interconnected cubes. Each cube in the body would represent a segment of the snake. The snake would move in a continuous manner, with each segment following the position of the previous segment.</p><p>A queue would allow this, where each segment&rsquo;s position would represent its current location in the arena. The head of the queue will hold the position vector of the snake&rsquo;s head, while the tail will hold the position vector of the last segment. Whenever the snake moves, the head of the queue (representing the snake&rsquo;s head) will be updated with its new position vector based on the user&rsquo;s input and the current direction of the snake. The rest of the segments in the queue will follow suit.</p><h1 id=references><strong>References</strong>
<a class=anchor href=#references>#</a></h1><p>[1] F. DUNN, “Matrices and Linear Transformations,” in 3D math primer for graphics and game development, S.l.: CRC PRESS, 2022</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/visualcomputing/showcase/commit/f2b7efe1a5d0b116e3a5535255e874b84b324183 title='Last modified by jurodriguezf | June 16, 2023' target=_blank rel=noopener><img src=/showcase/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 16, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#3d-snake-game><strong>3D Snake Game</strong></a></li><li><a href=#introduction><strong>Introduction</strong></a></li><li><a href=#background><strong>Background</strong></a><ul><li><a href=#solution-p5-sketch><strong>Solution: P5 Sketch</strong></a></li></ul></li><li><a href=#solution-code><strong>Solution: Code</strong></a></li><li><a href=#conclusions><strong>Conclusions</strong></a></li><li><a href=#future-work><strong>Future work</strong></a></li><li><a href=#references><strong>References</strong></a></li></ul></nav></div></aside></main></body></html>